<!DOCTYPE html><html lang='en'><head><meta charset='utf-8'><meta name='thumbnail' content='https://kokorobot.ca/media/services/thumbnail.jpg' /><meta name='viewport' content='width=device-width,initial-scale=1'><link rel='alternate' type='application/rss+xml' title='RSS Feed' href='../links/rss.xml' /><link rel='stylesheet' type='text/css' href='../links/main.css'><link rel='shortcut icon' type='image/png' href='../media/services/shortcut.png'><title>Rek Bell &mdash; pandoc</title></head><body><header><h1><a href='home.html'>Rek Bell</a></h1>
<h2><a href='home.html'>⬟</a></h2>

<ul>
	<li><a href="about.html"><img src="../media/interface/menu/about_tn.png" alt='' width="140" height="140" />About</a></li>
	<li><a href="projects.html"><img src="../media/interface/menu/projects_tn.png" alt='' width="140" height="140" />Projects</a></li>
	<li><a href="books_for_children.html"><img src="../media/interface/menu/childrens_books_tn.png" alt='' width="140" height="140" />Books</a></li>
	<li><a href="games.html"><img src="../media/interface/menu/illustration_tn.png" alt='' width="140" height="140" />Games</a></li>
	<li><a href="stories.html"><img src="../media/interface/menu/stories_tn.png"alt='' width="140" height="140" />Stories</a></li>
	<li><a href="store.html"><img src="../media/interface/menu/store_tn.png" alt='' width="140" height="140" />Store</a></li>
	<li><a href="notes.html"><img src="../media/interface/menu/notes_tn.png" alt='' width="140" height="140" />Notes</a></li>
	<li><a href="how-to.html"><img src="../media/interface/menu/howto_tn.png" alt='' width="140" height="140" />How-to</a></li>
</ul>
</header><main>

<!-- Generated file, do not edit -->

<p>This is a list of notes I've compiled when came time to learn how to generate PDFs, and e-books with free, open-source software.</p>

<h2>A note on TeX</h2>

<p>When I first started making books, I used Markdown and Pandoc, as well as a little bit of TeX(bits I grabbed from a collection of posts on StackOverflow) to generate a working document. Pandoc funnels the markdown document into a PDF engine which typesets the whole thing-easy peasy but this way of generating a book has its limits. If you want to center text, to add a custom title page, or a copyright pages, learning a bit of TeX will permit you to modify a text more granularly.</p>

<p>Using Markdown and Pandoc is like flirting with TeX, I saw what this typesetting system can do, and it left me yearning for more. Emboldened by the 5 lines I had learned making Busy Doing Nothing(Ho hooo, yesss, I can do anythiiing), I learned 5 more lines to make Wiktopher, and then another 15, wading into the friendly familiar waters of Pandoc and Markdown all the while. This page is for people who want to just dip their toes into bookmaking, and learning a bit of TeX on the way.</p>

<p>"TeX was designed with two main goals in mind: to allow anybody to produce high-quality books with minimal effort, and to provide a system that would give exactly the same results on all computers, at any point in time."</p>

<p>My way of generating this book is certainly not the best way, but in the end I walked away with two books, and that was my goal :). I learn more TeX with every publication, and hope to work my way to a full publication coded in that language.</p>

<p>See the sources for <a href="https://git.sr.ht/~rabbits/wikbook" target="_blank">Wiktopher</a>, and for <a href="https://git.sr.ht/~rabbits/busydoingnothing" target="_blank">Busy Doing Nothing</a>.

<h3><a id='content'>Contents</a></h3>

<ul>
	<li><a href='#whatispandoc'>What is Pandoc?</a></li>
	<li><a href='#markdown'>Pandoc Markdown</a></li>
	<li><a href='#txtpdf'>From Markdown to PDF</a></li>
	<li><a href='#extensions'>Using Pandoc Markdown Extensions</a></li>
	<li><a href='#papersize'>Changing papersize</a></li>
	<li><a href='#addext'>Adding Extensions</a></li>
	<li><a href='#bookcover'>Book cover for PDF</a></li>
	<li><a href='#combinemaincover'>Combine cover with main PDF file</a></li>
	<li><a href='#latexpretty'>Paragraph indents and centering chapter headings</a></li>
	<li><a href='#titlecopyright'>Making a title and copyright page using Tex</a></li>
	<li><a href='#epub'>Making EPUBs</a></li>
	<li><a href='#mobi'>MOBI conversion</a></li>
</ul>

<p>If you have plans to export a PDF, you'll need the following:</p>

<ul>
	<li><a href="https://pandoc.org/MANUAL.html" target="_blank">Pandoc</a></li>
	<li><a href="https://tectonic-typesetting.github.io/en-US/index.html" target="_blank">Tectonic</a></li>
	<li><a href="https://www.ghostscript.com/" target="_blank">Ghostscript</a></li>
</ul>

<p>To generate MOBIs and EPUBs, you'll also need the following:</p> 

<ul>
	<li><a href="https://imagemagick.org/script/import.php" target="_blank">ImageMagick</a></li>
	<li><a href="https://calibre-ebook.com/" target="_blank">Calibre</a>.</li>
</ul>

<p>Now that you've installed all necessary tools, let's begin:</p>

<h3><a id='whatispandoc'>What is Pandoc?</a></h3>

<p><a href='https://pandoc.org/index.html' target="_blank">Pandoc</a> is a terminal utility that converts files from one markup format into another. You can convert an HTML page to Markdown, Markdown to PDF, Markdown to EPUB etc. It's a useful tool to create articles, scientific papers, and books.</p>

<p>When generating PDFs, Pandoc's use of <a href='https://www.latex-project.org/' target="_blank">LaTeX</a> (a document preparation system) encourages authors not to worry too much about the appearance of their documents but to concentrate on getting the right content. To find out how to install LaTeX, read <a href='pandoc_install.html#latex'>my tutorial</a>.</p> 

<h3><a id='markdown'>Pandoc Markdown</a></h3>

<p>Make sure that the file you want turned into a PDF has an <b>.md</b> extension, and take note of the path to your project file, as you'll need that to generate your PDF later. The next step is to add Pandoc Markdown syntax to the text.</p>

<p><a href='https://rmarkdown.rstudio.com/authoring_pandoc_markdown.html%23raw-tex' target="_blank">Pandoc Markdown</a> is an extended and slightly revised version of John Gruber’s <a href='https://daringfireball.net/projects/markdown/' target="_blank">Markdown syntax</a>. Markdown is a simple, and easy-to-use markup language to format plain-text content. This language is used to annotate a document in a way that is syntactically distinguishable from the text.</p>

<p>For example, to make text <b>bold</b>, add two asterisks on each side of the word:</p>

<pre>In January 2016, we bought our first sailboat, a **Yamaha 33**.</pre>

<p>Hash symbols preceding a word or phrase make a heading. Be sure to add a space between the hash and the first word:</p>

<pre>## Introduction</pre>

<img src="../media/content/pandoc_markdown.jpg" loading='lazy'>

<p>One hash would make the title bigger, three would make the heading smaller, four even smaller, five even smaller etc. Headings are important too for creating epubs, as Pandoc will use the headers to generate the table of contents of your e-book.</p>

<p>There is no easy equivalent to adding indents in the text, but it is possible by adding a bunch of spaces using:</p>

<pre>
&amp;nbsp;
</pre>

<p>It is <b>very</b> hacky though. I've not yet found a solution for this, not a simple one anyway. When writing paragraphs, <b>always add two spaces after each one</b> if you want spacing between them.</p>

<p><b>Footnotes.</b> To add footnotes to the text, add a number between square brackets after a specific word, like so: <b>[^1]</b>. An example text:</p>

<pre>Licky root[^1] is a popular herb because...</pre>

<p>The <b>[^1]</b> will render as a small '1' in the exported version of the text. Then in the document (end, beginning, doesn't matter), add the same number between square brackets again, followed with the footnotes you wish to have (directly following the number). For example:</p>

<pre>[^1]: Licky root is a plant that is often brewed as tea.</pre>

<p>That text won't appear in the document end, it'll appear on the same page where with the marker. This is what it will look like in the text:</p>

<img src="../media/content/pandoc_footnotes.jpg" loading='lazy' class='p'>

<h3><a id='txtpdf'>From Markdown to PDF</a></h3>

<p>To generate a PDF from your <b>.md</b> or <b>.txt</b> file, locate your project file using the terminal. Navigate to your project folder. The example below is if you'd saved your project file to Documents, under a folder named <b>myproject</b>.:</p>

<pre>cd Documents/myproject/</pre>

<p>Enter the following command, replacing <b>filename</b> with the name of your project file, and <b>filename_export</b> with for the final exported PDF file. To format the PDF, I use Tectonic a self-contained TeX/LaTeX engine, powered by XeTeX and TeXLive. I used to install TeXLive packages separately, but it is a bit messy, one system update corrupted my install and so I switched to Tectonic.</p>

<p>Enter the following:</p>

<pre>pandoc filename.txt --pdf-engine=tectonic -o filename_export.pdf</pre>

<p>In that same folder where you had your .txt file saved, you'll find your Pandoc-generated PDF.</p>

<h3><a id='extensions'>Using Pandoc Markdown Extensions</a></h3>

<p>In Pandoc, you can use extensions (see below) to specify the output of your PDF more granularly, say, if you want to change the paper size, add tables, footnotes etc.</p>

<h3><a id='papersize'>Changing papersize</a></h3>

<p>By default, the Pandoc PDF format is a4. If you want to change it, you'll have to add the following when generating the PDF in the command line:</p>

<pre>--variable=geometry:a5paper</pre>

<p>Appended with the rest, to generate the PDF from a Markdown file, it'll look like this:</p>

<pre>pandoc --variable=geometry:a5paper filename.txt --pdf-engine=tectonic -o filename_export.pdf</pre>

<p>If you're file is a <b>.md</b>, change the extension of your project file.</p>

<h3><a id='addext'>Adding extensions</a></h3>

<p>If you want add tables, you'll have to add an extension. Extensions are specified in the command line when generating a pdf. In the example below, after <b>-- from markdown</b>, I've added a <b>+</b> followed by the extension <b>simple tables</b>. If the extension name has two words, adding an underscore between them is necessary.</p>

<pre>--from markdown+simple_tables</pre>

<p>You can add more extensions, adding a <b>+</b> inbetween each one. In the example below, I've added both <b>simple tables</b> and <b>citations</b>.</p>

<pre>--from markdown+simple_tables+citations</pre>

<p>Below is an example of a terminal command for a PDF generated from a .txt file, in a5 format, with the simple tables extension.</p>

<pre>pandoc --variable=geometry:a5paper filename.txt --pdf-engine=tectonic --from markdown+simple_tables -o filename_export.pdf</pre>

<h3><a id='bookcover'>Book cover PDF</a></h3>

<p>If the goal is to make a book for print, say with lulu.com, you won't have to include a cover in the PDF. Lulu demands a separate template. The following is if you want to produce a PDF to be read digitally.</p>

<p>Adding a book cover for a PDF with Pandoc is not straightforward, unless the book is coded in TeX. One technique I used once is to use ImageMagick to convert the cover image into a PDF, and then to combine the PDFs together into yet another PDF.</p>

<p>Save the cover image in your project folder. If you put it in a separate folder, be sure to specify it. Now, use this ImageMagick command to convert the image to a PDF:</p>

<pre>convert cover.jpg cover.pdf</pre>

<p>To combine the cover with the main text pdf, use Ghostscript:</p>

<pre>gs -q -dNOPAUSE -dBATCH -sDEVICE=pdfwrite -s OutputFile=filename_final.pdf cover.pdf filename_export.pdf</pre>

<h3><a id='latexpretty'>Paragraph indents and centering chapter headings</a></h3>

<p>Indenting text is possible in a Markdown document by adding a series blank spaces(&amp;nbsp) before the line you wish to indent, but it is better to format it using <b>TeX</b>.</p>

<p>It is difficult for me to explain how to do this because I do not master the use of TeX. But I have found settings that do exactly what I need.</p>

<p>To beautify my chapters and sections, I created a file named <b>titlesec.tex</b>, with the following elements in the document(of course, all numbers are set as zeros, set your own):</p>

<pre>
\usepackage[bf,tiny,center]&lbrace;titlesec&rbrace;
\usepackage&lbrace;parskip&rbrace;
\usepackage&lbrace;indentfirst&rbrace;
\setlength&lbrace;\parindent&lbrace;0pt&rbrace;
\titlespacing*&lbrace;\chapter&rbrace;
   &lbrace;0pt&rbrace;% left
   &lbrace;0cm&rbrace;% before
   &lbrace;0em&rbrace;% after
\raggedbottom
</pre>

<ul>
	<li><b>[bf,tiny,center]&lbrace;titlesec&rbrace;</b>, centers text, and uses a small font for my title. <a href="https://www.overleaf.com/learn/latex/Sections_and_chapters#Customize_chapters_and_sections" target="_blank">Read more</a>.</li>
	<li><b>&lbrace;parskip&rbrace;</b>, a package which adds vertical space between paragraphs. The value of parskip without options is 6.0pt plus 2.0pt. It contains a stretchable glue component that helps LaTeX fit content onto the page and produce the best (optimal) page breaks. Note that page breaks can be forced with Markdown by using: (/newpage).</b>
	<li><b>&lbrace;\indentfirst&rbrace;</b>, a package that indents the first line of every paragraph.</li>
	<li><b>&lbrace;\parindent&rbrace;</b>, sets a specific length for the indentation.</li>
</ul>

<p>Example of a Pandoc command to generate a PDF that includes the formatting in titlesec.tex:</p>

<pre>pandoc --variable=geometry:a5paper filename.md --pdf-engine=tectonic --from markdown+line_blocks+inline_notes --toc -V toc-title:"Table of Contents" --toc-depth=2 --include-in-header=titlesec.tex -o final.pdf
</pre>

<h3><a id='titlepage'>Making a title page with TeX</a></h3>

<p>See the <a href='../media/content/pandoc_titlepage.png'>title page</a> for <a href='wiktopher.html' class='local'>wiktopher</a>. I used similar code to generate a copyright page.</p>

<p>Below is what I used to generate the above page. Making a title page with TeX is completely optional. I didn't make a fancy title page for <a href='busy_doing_nothing.html' class='local'>busy doing nothing</a>, but I really wanted one for <a href='wiktopher.html' class='local'>wiktopher</a> so I decided to learn some TeX.</p>

<p>This code is saved as a <b>.tex</b> file that I've named <b>titlepage.tex</b>, and is generated as a PDF with Pandoc. All text is centered(\centering) which includes an image on top (\include graphics), the book title(\huge\bfseries), the book subtitle(\LARGE \textsc), the author name (\Large\itshape), the editor name, and the studio name(\large \textsc):</p>

<pre>
\begin&lbrace;document&rbrace;
\begin&lbrace;titlepage&rbrace;
   \centering
   \includegraphics&lbrace;media/image.jpg&rbrace;\par
   &lbrace;\huge\bfseries Wiktopher\par&rbrace;
   &lbrace;\LARGE \textsc&lbrace;--- Desert Tales ---&rbrace;\par&rbrace;
   \vspace&lbrace;0.50cm&rbrace;
   &lbrace;\Large\itshape Rek Bell\par&rbrace;
   \vspace&lbrace;1cm&rbrace;
   Edited by\par
   Devine Lu Linvega\vspace&lbrace;1cm&rbrace;
   \vfill
   &lbrace;\large \textsc&lbrace;Hundred Rabbits&rbrace;\par&lbrace; 
   \vfill
% Bottom of the page
   &lbrace;\large \today\par&rbrace;
\end&lbrace;titlepage&rbrace;
\end&lbrace;document&rbrace;
</pre>

<ul>
	<li><b>\par</b>, it forces a new paragraph.</li>
	<li><b>\textsc</b>, a small caps font style.</b>
	<li><b>\bfseries</b>, declares that the text inside the braces must be formatted in bold.</li>
	<li><b>\today</b>, enters today's date in the generated page.</li>
</ul>

<p>Font sizes range from very small to very big, it affects all text between the curly brackets. Here are all the possibilities:<br>\tiny, \scriptsize, \footnotesize, \small, \normal size, \large, \Large, \LARGE, \huge and \Huge.</p>

<p>For more information about font style, read <a href="https://www.overleaf.com/learn/latex/Font_sizes%2C_families%2C_and_styles" target="_blank">this page</a>.</p>

<p>Make the file into a PDF:</p>

<pre>
pandoc --variable=geometry:a5paper filename.md --pdf-engine=tectonic --include-in-header=titlepage.tex -o titlepage.pdf
</pre>

<p>As I said, I'm not expert... I don't know how to generate the title page without calling the working source file(the markdown file) in the command, but it's the only way I've gotten it to work. This command will only generate a single page, which in a later step will be combined to the rest of the PDF file using Ghostscript.</p>

<h3><a id='together'>Combining all pages into a single PDF</a></h3>

<p>Combining all of the invidually-generated PDFs with Ghostscript:</p>

<pre>gs -q -dNOPAUSE -dBATCH -sDEVICE=pdfwrite -s OutputFile=filename_final.pdf cover.pdf titlepage.pdf filename_export.pdf</pre>

<p>The reason that I generated all of those pages invidiually is because they are generated from two separate <b>.tex</b> files. This is a sort of workaround, to be able to continue using Markdown for the main body text while avoiding heavy use of TeX. A text written entirely in TeX would mean even more customization, but it requires learning a lot more code. I want to get there someday, but I also want to publish books :)... so I am going the slow route.</p>

<h3><a id='epub'>Making epubs</a></h3>

<p>EPUB is a popular ebook format, but if you convert a Markdown file to an epub it may break some of your formatting. For example, EPUBs ignore the <b>\newpage</b> Markdown tag, but assigning a <b>page break</b> to a specific level of header with css fixes that problem. For EPUBs it is a good idea to use css to control the final look of the document.</p>

<p>First step is to create a blank text file, and to save it as <b>epub.css</b>.</p>

<p>I prefer not to modify the look too much, so I keep my css to minimum. For example:</p>

<pre>
body &lbrace;font-size: 14px&rbrace;
table &lbrace;font-size: 14px&rbrace;
h4 &lbrace;page-break-before: always;&rbrace;
h2 &lbrace;page-break-before: always;&rbrace;
blockquote &lbrace;font-style: italic;&rbrace;
img &lbrace;max-width: 100%&rbrace;
</pre>

<p>I don't recommend setting a fixed font size like in the example above, as the font may be too small to read on a phone. I specified a <b>max-width</b> for images otherwise they have a tendency to spill out of the page. Of course, these are only a few of the many things one can do to improve the look of documents with css.</p>

<p>When exporting the file as an EPUB with Pandoc, add the extension like the above example, along with arguments to generate a table of contents from your list of headers, the book's metadata, a book cover and your css file.</p> 

<p><b>Table of Contents:</b> To change the name of the table of the contents generated by Pandoc, add the following command, changing 'custom text' for the desired name of your table of contents:</p>

<pre>-V toc-title:"Custom text"</pre>

<p>If the table of contents depth is not specified, it defaults to 3 (level 1, 2 and 3 headers will be included in the generated table of contents). To keep the table to a depth of level 2, add:</p>

<pre>--toc-depth=2</pre>

<p><b>Metadata file:</b> A metadata file includes all the author, rights and publishing information. Create a new file and save it as <b>metadata.yaml</b>. Then, add the following:</p>

<pre>
---
title: Busy Doing Nothing
subtitle: 51 days from Canada to Japan
author: Rek Bell
publisher: Hundredrabbits
table-of-contents: true
lang: en-CA
rights: © 2021 MyCompany, *your chosen license*
documentclass: book
...
</pre>

<p><b>**NOTE</b>: The three most commonly used standard document-classes in TeX include: article, report and book. Different document-classes have different default settings. The first time I published a book I omitted adding a document class entirely, and the text renders fine. Adding a "book" class will add settings that make the text more pleasant to read, like it'll align text on either the left, or right, to account for the book binding, it'll also add the chapter name at the top of the page.</p>

<p>The text in the .yaml file need to be delimited by a line of three hyphens (---) at the top and a line of three hyphens (---) or three dots (...) at the bottom. Metadata will be taken from the fields of the YAML object and added to any existing document metadata. See more about <a href='https://pandoc.org/MANUAL.html#metadata-blocks' target="_blank">metadata files</a>. Next, pass it to Pandoc as an argument:</p>

<pre>--epub-metadata=metadata.yaml</pre>

<p><b>Book cover</b>: To add a cover, save the file to the folder with the rest of your text, and pass it to Pandoc as an argument:</p>

<pre>--epub-cover-image=cover.jpg</pre>

<p>The final Pandoc command to convert a file from Markdown to EPUB would look like this (with variations, depending on the extensions you choose):</p>

<pre>~pandoc filename.md --from markdown+simple_tables+line_blocks --toc -V toc-title:"Table of Contents" --toc-depth=2 --epub-metadata=metadata.yaml --epub-cover-image=cover.jpg --css epub.css -w epub -o filename.epub</pre>

<p>Test your book on a variety of devices before publishing it.</p>

<h3><a id='mobi'>MOBI</a></h3>

<p>Pandoc cannot convert files to MOBI, but it's possible to convert it using <b>Calibre</b>. To start, make an EPUB (steps above). To find out how to install Calibre, read <a href='pandoc_install.html#calibre'>my tutorial</a>.</p>

<p>Run the following command in the terminal:</p>

<pre>ebook-convert "input_file.epub" "output_file.mobi"</pre>

<p>input_file is the input and output_file is the output. Both must be specified as the first two arguments to the command. It's possible to add more options to further change the look of the output file. There are too many options to name here, but all are listed <a href='https://manual.calibre-ebook.com/generated/en/ebook-convert.html' target='_blank'>here</a>.</p>

<p>Calibre doubles as a book viewer, so you can test your book on that. Note that like with an EPUB, test the file on as many devices as you can.</p>

<p>Now, all that's left is to publish your e-book! I personally choose not to use Amazon, and publish on <a href='https://itch.io/' target="_blank">itch.io</a>. There are no publishing fees, and with it, it's possible to automate uploads using <a href='https://itch.io/docs/butler/' target="_blank">Butler</a> (itch.io's command line tools) if say, you want to publish changes to your book fast.</p>

<img src='../media/content/pandoc_pdf.png' loading='lazy'>

<p>I have published the book from this tutorial, <a href='busy_doing_nothing.html' class='local'>busy doing nothing</a> as a paperback book. I printed using Lulu, a print-on-demand service. See it <a href='https://www.lulu.com/en/us/shop/rekka-bellum-and-devine-lu-linvega/busy-doing-nothing/paperback/product-rqgmdj.html?page=1&pageSize=4' target='_blank'>here(Lulu.com link)</a>.</p>

<img src='../media/content/busydoingnothing_paperback2.jpg' loading='lazy'>

<p>If anyone is interested in me writing about this let me know, and I will. Also, if you've read this, and have questions don't hesitate to <a href='rek.html#contact'>ask me</a>! I'll do my best to help.</p>

</main><footer><span style='float:right'>Edited on Mon Mar 25 09:46:21 2024
 <a href='https://github.com/rekkabell/kokorobot/edit/main/src/inc/pandoc.htm'>[edit]</a><br/></span><b>Rek Bell</b> © 2011-2024 <a href='http://webring.xxiivv.com/#random'>[Webring]</a> <a href='https://merveilles.town/@rek'>[Masto]</a> <a href='politics.html'>[Politics]</a> <a href='bookmarks.html'>[Links]</a> — <a href='https://github.com/rekkabell/kokorobot/blob/main/LICENSE' target='_blank'>BY-NC-SA 4.0</a></footer></body></html>